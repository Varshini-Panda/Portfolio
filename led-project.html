<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LED Automation Framework - POC | Deepavarshini V</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <style>
        /* Reuse your portfolio styles */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --text: #333;
            --text-light: #777;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            color: var(--text);
            line-height: 1.6;
            background-color: #f9f9f9;
            padding-top: 80px;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background: var(--secondary);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        .btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        /* Project Header */
        .project-header {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 60px 0;
            text-align: center;
            margin-bottom: 40px;
        }

        .project-title {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .project-subtitle {
            font-size: 1.4rem;
            color: var(--secondary);
            max-width: 800px;
            margin: 0 auto;
        }

        /* Project Content */
        .project-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 40px;
            margin-bottom: 50px;
        }

        .main-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .sidebar {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            align-self: start;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary);
        }

        .section h3 {
            color: var(--primary);
            margin: 25px 0 15px;
        }

        .section p {
            margin-bottom: 15px;
            color: var(--text-light);
        }

        .section ul, .section ol {
            margin-left: 20px;
            margin-bottom: 20px;
            color: var(--text-light);
        }

        .section li {
            margin-bottom: 10px;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .tech-item {
            background: var(--light);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tech-item i {
            color: var(--secondary);
        }

        .code-block {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid var(--secondary);
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 600;
        }

        .feature-list {
            list-style: none;
            margin-left: 0;
        }

        .feature-list li {
            margin-bottom: 15px;
            padding-left: 30px;
            position: relative;
        }

        .feature-list li i {
            position: absolute;
            left: 0;
            top: 2px;
            color: var(--secondary);
        }

        .flow-diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .workflow-steps {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin: 40px 0;
            align-items: center;
        }

        .workflow-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
            width: 80%;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
        }

        .workflow-step.animate {
            opacity: 1;
            transform: translateY(0);
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            color: var(--secondary);
            font-size: 1.1rem;
            display: block;
            margin-bottom: 10px;
        }

        .step-arrow {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--secondary);
            font-size: 28px;
            z-index: 2;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .workflow-step:last-child .step-arrow {
            display: none;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            color: var(--secondary);
            text-decoration: none;
            font-weight: 600;
        }

        .code-explanation {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 3px solid var(--secondary);
        }

        .code-explanation h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .status-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .status-table th, .status-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .status-table th {
            background-color: var(--secondary);
            color: white;
        }

        .status-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        @media (max-width: 968px) {
            .project-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: -1;
            }

            .workflow-step {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html#projects" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Portfolio
        </a>

        <div class="project-header">
            <h1 class="project-title">LED Automation Framework - POC</h1>
            <p class="project-subtitle">A Python-based HID device interface for capturing and interpreting LED status signals</p>
        </div>

        <div class="project-content">
            <div class="main-content">
                <div class="section">
                    <h2>Project Overview</h2>
                    <p>The LED Automation Framework is a proof-of-concept (POC) project that demonstrates how to interface with Human Interface Devices (HID) using Python to capture LED status signals and convert raw data into meaningful status messages. This framework was designed to automate the testing and monitoring of device status indicators in embedded systems.</p>

                    <p>The application connects to HID devices using vendor and product IDs, captures signal data, processes the raw byte information, and translates it into human-readable status messages. It also includes comprehensive reporting capabilities to document the testing process and results.</p>
                </div>

                <div class="section">
                    <h2>Key Features</h2>
                    <ul class="feature-list">
                        <li><i class="fas fa-check-circle"></i> <strong>HID Device Integration:</strong> Connects to HID devices using vendor and product IDs</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Signal Capture:</strong> Captures and processes raw LED signal data</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Status Interpretation:</strong> Converts raw byte data into human-readable status messages</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Comprehensive Reporting:</strong> Generates detailed test reports with timestamps and results</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Error Handling:</strong> Robust error handling and connection management</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Modular Design:</strong> Easily extendable for different status codes and devices</li>
                    </ul>
                </div>

                <div class="section">
                    <h2>Technical Implementation</h2>

                    <h3>Architecture & Workflow</h3>
                    <p>The framework follows a modular architecture with clear separation of concerns between device connection, data reading, signal processing, and reporting functions.</p>

                    <div class="workflow-steps">
                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Initialize the framework</strong> and start the test report
                            </div>
                            <div class="step-arrow"><i class="fas fa-chevron-down"></i></div>
                        </div>

                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Connect to HID device</strong> using vendor and product IDs
                            </div>
                            <div class="step-arrow"><i class="fas fa-chevron-down"></i></div>
                        </div>

                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Capture raw signal data</strong> from the connected device
                            </div>
                            <div class="step-arrow"><i class="fas fa-chevron-down"></i></div>
                        </div>

                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Process and interpret</strong> the raw data into status messages
                            </div>
                            <div class="step-arrow"><i class="fas fa-chevron-down"></i></div>
                        </div>

                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Generate comprehensive report</strong> with results and timestamps
                            </div>
                            <div class="step-arrow"><i class="fas fa-chevron-down"></i></div>
                        </div>

                        <div class="workflow-step">
                            <div class="step-content">
                                <strong>Close device connection</strong> and finalize the report
                            </div>
                        </div>
                    </div>

                    <h3>Code Explanation</h3>
                    <p>The framework is implemented in Python with several key functions that handle different aspects of the process:</p>

                    <h4>1. Device Connection Functions</h4>
                    <p>These functions handle the connection to the HID device:</p>

                    <div class="code-block">
                        <div class="code-header">HID Device Connection</div>
                        <pre><code class="language-python">
    try:
        current_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        filter = hid.HidDeviceFilter(vendor_id=vendor_id, product_id=product_id)
        devices = filter.get_devices()
        if devices:
            device = devices[0]
            device.open()
            print("HID Device connected successfully")
            return True
        else:
            print("No HID device connected")
            return False
    except Exception as e:
        print(f"Error occurred: {e}")
        return False
                        </code></pre>
                    </div>

                    <div class="code-explanation">
                        <h4>Explanation:</h4>
                        <p>This code establishes a connection to an HID device using specific vendor and product IDs. It uses the pywinusb library to filter and find compatible devices. The function:</p>
                        <ul>
                            <li>Creates a device filter with the specified IDs</li>
                            <li>Attempts to find compatible devices</li>
                            <li>Logs the connection attempt to the report system</li>
                            <li>Opens the device if found and returns connection status</li>
                            <li>Includes comprehensive error handling</li>
                        </ul>
                    </div>

                    <h4>2. Data Reading Functions</h4>
                    <p>These functions handle reading data from the connected device:</p>

                    <div class="code-block">
                        <div class="code-header">Data Reading Implementation</div>
                        <pre><code class="language-python">
    try:
        if device and device.is_opened():
            received_data = []
            def handle_data(data):
                received_data.extend(data)
            device.set_raw_data_handler(handle_data)
            time.sleep(5.0)
            if received_data:
                data_str = ' '.join(str(byte) for byte in received_data)
                return data_str
            return None
    except Exception as e:
        print(f"Error occurred while reading data: {e}")
        return None
                        </code></pre>
                    </div>

                    <div class="code-explanation">
                        <h4>Explanation:</h4>
                        <p>These functions handle data reading and connection management:</p>
                        <ul>
                            <li><code>read_data()</code> sets up a raw data handler to capture incoming data from the HID device</li>
                            <li>It waits for 5 seconds to collect data, then formats it as a string</li>
                            <li>All data reading activities are logged to the report system</li>
                            <li><code>close()</code> properly closes the device connection when done</li>
                            <li>Both functions include error handling and reporting</li>
                        </ul>
                    </div>

                    <h4>3. Signal Processing Functions</h4>
                    <p>These functions process the raw data and interpret status codes:</p>

                    <div class="code-block">
                        <div class="code-header">Signal Processing Implementation</div>
                        <pre><code class="language-python">
            i = 0
            while i + 9 <= len(signal_bytes):
                if signal_bytes[i] == '0' and ''.join(signal_bytes[i + 1:i + 6]) == '11233':
                    status_code = ''.join(signal_bytes[i + 6:i + 9])
                    comm_code = ''.join(signal_bytes[i + 6:i + 9])
                    print(f"Processing message: status_signal=11233, status_code={status_code}")
                    if Parameter == 'Status_LED':
                        if status_code == "110":
                            msg['Status_LED'] = "System is in Demand"
                        elif status_code == "111":
                            msg['Status_LED'] = "System is in Demand"
                        # Additional status code handling...
                    elif Parameter == 'COMM_LED':
                        if comm_code == "200":
                            msg['COMM_LED'] = "No Device connected"
                        elif comm_code == "210":
                            msg['COMM_LED'] = "1 Device connected"
                        # Additional communication code handling...
                    elif Parameter == '24V_COMM_LED':
                        if comm_code == "401":
                            msg['24V_COMM_LED'] = "System is in 24V mode"
                        print(f"24V_COMM_LED = {msg['24V_COMM_LED']}")
                    else:
                        msg = "Invalid message"
                    my_value = msg[Parameter]
                    all_val = msg
                    i += 64
                else:
                    i += 1
            if Parameter == "*":
                return all_val
            else:
                return my_value
        else:
            print("No device connected")
    except Exception as e:
        print(f"Error occurred: {e}")
        Report_Init.Put_in_Report(time.ctime(), "Error in data collection", "No Error", str(e), "N/A", "FAIL")
                        </code></pre>
                    </div>

                    <div class="code-explanation">
                        <h4>Explanation:</h4>
                        <p>This is the core function that processes the raw signal data:</p>
                        <ul>
                            <li>It reads data from the device and splits it into individual bytes</li>
                            <li>Looks for specific patterns in the data (starting with '0' followed by '11233')</li>
                            <li>Extracts status codes from predetermined positions in the data stream</li>
                            <li>Maps these codes to human-readable status messages based on the parameter requested</li>
                            <li>Handles three different types of LED status parameters: Status_LED, COMM_LED, and 24V_COMM_LED</li>
                            <li>Includes comprehensive error handling and reporting</li>
                        </ul>
                    </div>

                    <h4>4. Status Code Mapping</h4>
                    <p>The framework interprets various status codes into meaningful messages:</p>

                    <table class="status-table">
                        <tr>
                            <th>LED Type</th>
                            <th>Status Code</th>
                            <th>Interpretation</th>
                        </tr>
                        <tr>
                            <td rowspan="5">Status_LED</td>
                            <td>110, 111, 112</td>
                            <td>System is in Demand</td>
                        </tr>
                        <tr>
                            <td>113</td>
                            <td>System Issue or Bug</td>
                        </tr>
                        <tr>
                            <td>120, 121, 122</td>
                            <td>Active Alert</td>
                        </tr>
                        <tr>
                            <td>123</td>
                            <td>Active alert and Internal Comm alert published</td>
                        </tr>
                        <tr>
                            <td>100</td>
                            <td>System is in Idle or OFF</td>
                        </tr>
                        <tr>
                            <td rowspan="10">COMM_LED</td>
                            <td>200</td>
                            <td>No Device connected</td>
                        </tr>
                        <tr>
                            <td>210</td>
                            <td>1 Device connected</td>
                        </tr>
                        <tr>
                            <td>220</td>
                            <td>2 Devices connected</td>
                        </tr>
                        <tr>
                            <td>230</td>
                            <td>3 Devices connected</td>
                        </tr>
                        <tr>
                            <td>240</td>
                            <td>4 Devices connected</td>
                        </tr>
                        <tr>
                            <td>250</td>
                            <td>5 Devices connected</td>
                        </tr>
                        <tr>
                            <td>260</td>
                            <td>6 Devices connected</td>
                        </tr>
                        <tr>
                            <td>270</td>
                            <td>7 Devices connected</td>
                        </tr>
                        <tr>
                            <td>280</td>
                            <td>8 Devices connected</td>
                        </tr>
                        <tr>
                            <td>301</td>
                            <td>Startup</td>
                        </tr>
                        <tr>
                            <td>24V_COMM_LED</td>
                            <td>401</td>
                            <td>System is in 24V mode</td>
                        </tr>
                    </table>

                    <h4>5. Utility Functions</h4>
                    <p>These functions provide additional functionality for reading and verifying LED status:</p>

                    <div class="code-block">
                        <div class="code-header">Utility Functions</div>
                        <pre><code class="language-python">

def read_and_verify_LED_status(Parameter, str_expected):
    step_name = 'Read_Verify_LED_Value' + Parameter
    actual_value = check_status(Parameter)
    'Comparing with the expected value using Verify_User_Libraries'
    Verify_User_Library.string(step_name, actual_value, str_expected)
    return actual_value

                        </code></pre>
                    </div>

                    <div class="code-explanation">
                        <h4>Explanation:</h4>
                        <p>These utility functions provide additional capabilities:</p>
                        <ul>
                            <li><code>read_LED_status()</code> reads a specific LED status and reports the result</li>
                            <li><code>read_and_verify_LED_status()</code> reads a status and verifies it against an expected value</li>
                            <li>The main execution block demonstrates how to use the framework</li>
                            <li>It starts a report, connects to the device, checks statuses, and then closes the connection</li>
                        </ul>
                    </div>
                </div>

                <div class="section">
                    <h2>Advantages & Benefits</h2>

                    <h3>Automation Efficiency</h3>
                    <p>The framework automates the process of reading and interpreting LED status signals, significantly reducing manual testing time and effort.</p>

                    <h3>Accuracy Improvement</h3>
                    <p>By automating the signal interpretation process, the framework eliminates human error in reading and understanding LED status codes.</p>

                    <h3>Comprehensive Reporting</h3>
                    <p>The integrated reporting system provides detailed documentation of all testing activities, results, and errors for audit trails and analysis.</p>

                    <h3>Extensibility</h3>
                    <p>The modular design makes it easy to extend the framework to support additional status codes, device types, and interpretation rules.</p>

                    <h3>Cross-Platform Potential</h3>
                    <p>While currently implemented for Windows using pywinusb, the framework could be adapted for other platforms using different HID libraries.</p>
                </div>

                <div class="section">
                    <h2>Technical Challenges & Solutions</h2>

                    <h3>Challenge 1: HID Device Communication</h3>
                    <p><strong>Problem:</strong> Establishing reliable communication with HID devices using vendor and product IDs.</p>
                    <p><strong>Solution:</strong> Implemented the pywinusb library which provides a Pythonic interface for working with HID devices on Windows.</p>

                    <h3>Challenge 2: Signal Pattern Recognition</h3>
                    <p><strong>Problem:</strong> Identifying meaningful patterns in raw byte data from the device.</p>
                    <p><strong>Solution:</strong> Developed a pattern matching algorithm that looks for specific byte sequences that indicate the start of a status message.</p>

                    <h3>Challenge 3: Status Code Interpretation</h3>
                    <p><strong>Problem:</strong> Mapping raw status codes to human-readable messages.</p>
                    <p><strong>Solution:</strong> Created a comprehensive mapping system that can be easily extended as new status codes are defined.</p>

                    <h3>Challenge 4: Error Handling</h3>
                    <p><strong>Problem:</strong> Ensuring robust operation when devices are disconnected or send unexpected data.</p>
                    <p><strong>Solution:</strong> Implemented comprehensive exception handling and connection verification throughout the framework.</p>
                </div>

                <div class="section">
                    <h2>Potential Applications</h2>

                    <h3>Embedded Systems Testing</h3>
                    <p>The framework can be used to automate testing of embedded systems that use LED status indicators, particularly in manufacturing and quality assurance environments.</p>

                    <h3>Device Monitoring</h3>
                    <p>It could be adapted for continuous monitoring of device status in operational environments, alerting operators to status changes.</p>

                    <h3>Protocol Development</h3>
                    <p>The pattern recognition approach could be applied to other protocols and communication systems beyond HID devices.</p>

                    <h3>Research and Development</h3>
                    <p>The framework provides a foundation for researching human-device interaction patterns and developing improved status indication systems.</p>
                </div>
            </div>

            <div class="sidebar">
                <div class="section">
                    <h2>Project Details</h2>

                    <div class="tech-stack">
                        <div class="tech-item">
                            <i class="fab fa-python"></i>
                            <span>Python</span>
                        </div>
                        <div class="tech-item">
                            <i class="fas fa-usb"></i>
                            <span>HID Protocol</span>
                        </div>
                        <div class="tech-item">
                            <i class="fas fa-signal"></i>
                            <span>Signal Processing</span>
                        </div>
                        <div class="tech-item">
                            <i class="fas fa-table"></i>
                            <span>Data Interpretation</span>
                        </div>
                        <div class="tech-item">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Test Reporting</span>
                        </div>
                        <div class="tech-item">
                            <i class="fas fa-microchip"></i>
                            <span>Embedded Systems</span>
                        </div>
                    </div>

                    <h3>Key Features</h3>
                    <ul>
                        <li>HID device communication</li>
                        <li>Raw signal data capture</li>
                        <li>Pattern recognition algorithm</li>
                        <li>Status code interpretation</li>
                        <li>Comprehensive test reporting</li>
                        <li>Extensible architecture</li>
                    </ul>

                    <h3>Technical Specifications</h3>
                    <ul>
                        <li><strong>Platform:</strong> Windows</li>
                        <li><strong>Library:</strong> pywinusb</li>
                        <li><strong>Communication:</strong> HID Protocol</li>
                        <li><strong>Data Format:</strong> Raw byte signals</li>
                        <li><strong>Output:</strong> Human-readable status messages</li>
                    </ul>

                    <h3>Project Impact</h3>
                    <p>This POC demonstrates how Python can be used to interface with hardware devices and automate the interpretation of status indicators, with potential applications in manufacturing, quality assurance, and device monitoring.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Add copy functionality to code blocks
        document.querySelectorAll('.code-block').forEach(block => {
            const button = document.createElement('button');
            button.innerHTML = '<i class="far fa-copy"></i>';
            button.classList.add('btn-copy');
            button.style.position = 'absolute';
            button.style.right = '10px';
            button.style.top = '10px';
            button.style.padding = '5px 10px';
            button.style.fontSize = '0.8rem';
            button.style.background = 'var(--secondary)';
            button.style.color = 'white';
            button.style.border = 'none';
            button.style.borderRadius = '3px';
            button.style.cursor = 'pointer';

            block.style.position = 'relative';
            block.querySelector('.code-header').appendChild(button);

            button.addEventListener('click', () => {
                const code = block.querySelector('code').innerText;
                navigator.clipboard.writeText(code).then(() => {
                    button.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        button.innerHTML = '<i class="far fa-copy"></i>';
                    }, 2000);
                });
            });
        });

        // Animate workflow steps on scroll
        document.addEventListener('DOMContentLoaded', function() {
            const workflowSteps = document.querySelectorAll('.workflow-step');

            function checkVisibility() {
                workflowSteps.forEach((step, index) => {
                    const position = step.getBoundingClientRect();

                    // If element is in viewport
                    if(position.top < window.innerHeight * 0.85 && position.bottom >= 0) {
                        // Add delay based on index for sequential animation
                        setTimeout(() => {
                            step.classList.add('animate');
                        }, index * 200);
                    }
                });
            }

            // Check on load and scroll
            checkVisibility();
            window.addEventListener('scroll', checkVisibility);
        });
    </script>
</body>

</html>
